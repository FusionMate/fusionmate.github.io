"use strict";(self.webpackChunkFusionMate_Frontend=self.webpackChunkFusionMate_Frontend||[]).push([[8393],{8393:(K,x,a)=>{a.r(x),a.d(x,{DetailModule:()=>q});var u=a(6814),f=a(8109),h=a(5861),Z=a(1654),v=a(2096),y=a(4664),T=a(2572),O=a(4825),k=a(7398),g=a(4036),t=a(5879),P=a(3967),w=a(7700),A=a(1391),D=a(2426),F=a(3896),I=a(4362),p=a(6223),b=a(2296),M=a(617);const S=["talkField"];function U(e,s){1&e&&(t.TgZ(0,"div",6),t._uU(1,"Owned"),t.qZA())}function z(e,s){1&e&&(t.TgZ(0,"div",6),t._uU(1,"Created"),t.qZA())}function J(e,s){if(1&e&&(t.TgZ(0,"div",25),t._UZ(1,"div",26),t.TgZ(2,"div",27),t._uU(3),t.qZA(),t.TgZ(4,"div",28),t._uU(5),t.ALo(6,"async"),t.qZA()()),2&e){const n=t.oxw().$implicit,i=t.oxw(2);t.xp6(1),t.Akn("background: url("+i.assistant.imgURI+")"),t.xp6(2),t.Oqu(i.assistant.name),t.xp6(2),t.Oqu(t.lcZ(6,4,n.msg$)||"I'm thinking...")}}function Y(e,s){if(1&e&&(t.TgZ(0,"div",29),t._UZ(1,"div",30),t.TgZ(2,"div",31),t._uU(3,"You"),t.qZA(),t.TgZ(4,"div",32),t._uU(5),t.ALo(6,"async"),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(5),t.Oqu(t.lcZ(6,1,n.msg$))}}function $(e,s){if(1&e&&(t.ynx(0),t.YNc(1,J,7,6,"div",23),t.YNc(2,Y,7,3,"div",24),t.BQk()),2&e){const n=s.$implicit;t.xp6(1),t.Q6J("ngIf",0==n.from),t.xp6(1),t.Q6J("ngIf",1==n.from)}}function Q(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",34)(1,"input",35),t.NdJ("ngModelChange",function(r){t.CHM(n);const o=t.oxw(3);return t.KtG(o.msg=r)})("keyup.enter",function(){t.CHM(n);const r=t.oxw(3);return t.KtG(r.sendMsg())}),t.qZA(),t.TgZ(2,"button",36),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(3);return t.KtG(r.sendMsg())}),t.TgZ(3,"mat-icon"),t._uU(4,"send"),t.qZA()()()}if(2&e){const n=t.oxw(3);t.xp6(1),t.Q6J("ngModel",n.msg)}}function N(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",34)(1,"span",37),t._uU(2," You need to "),t.TgZ(3,"a",38),t.NdJ("click",function(r){t.CHM(n);const o=t.oxw(3);return t.KtG(o.mint(r,o.assistant))}),t._uU(4,"Mint Assistant"),t.qZA(),t._uU(5," first. "),t.qZA()()}}function H(e,s){if(1&e&&(t.ynx(0),t.YNc(1,Q,5,1,"div",33),t.YNc(2,N,6,0,"div",33),t.BQk()),2&e){const n=s.$implicit;t.xp6(1),t.Q6J("ngIf",n),t.xp6(1),t.Q6J("ngIf",!n)}}const B=function(e){return[e]};function L(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"div",3),t.TgZ(3,"h2",4),t._uU(4),t.qZA(),t.TgZ(5,"div",5)(6,"div",6)(7,"span",7),t._uU(8),t.ALo(9,"async"),t.qZA(),t._uU(10),t.qZA(),t.YNc(11,U,2,0,"div",8),t.ALo(12,"async"),t.YNc(13,z,2,0,"div",8),t.ALo(14,"async"),t.qZA(),t.TgZ(15,"p",9),t._uU(16),t.qZA(),t.TgZ(17,"button",10),t.NdJ("click",function(r){t.CHM(n);const o=t.oxw();return t.KtG(o.harvest(r,o.assistant))}),t._uU(18,"Harvest"),t.qZA(),t.TgZ(19,"h2",11),t._uU(20,"Text Feed"),t.qZA(),t.TgZ(21,"div",12),t._UZ(22,"img",13)(23,"div",14)(24,"div",15)(25,"div",16)(26,"div",17),t.qZA()(),t.TgZ(27,"div",18)(28,"h2",19),t._uU(29),t.qZA(),t.TgZ(30,"div",20,21),t.YNc(32,$,3,2,"ng-container",22),t.qZA(),t.YNc(33,H,3,2,"ng-container",22),t.ALo(34,"async"),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(2),t.Akn("background: url("+n.assistant.imgURI+")"),t.xp6(2),t.Oqu(n.assistant.name),t.xp6(4),t.hij(" ",t.lcZ(9,11,n.assistant.mintAmount$)||0,""),t.xp6(2),t.hij("/",n.assistant.maxSupply,""),t.xp6(1),t.Q6J("ngIf",t.lcZ(12,13,n.assistant.owned$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(14,15,n.assistant.isMaker$)),t.xp6(3),t.Oqu(n.assistant.description),t.xp6(13),t.Oqu(n.assistant.name),t.xp6(3),t.Q6J("ngForOf",n.msgList),t.xp6(1),t.Q6J("ngForOf",t.VKq(19,B,t.lcZ(34,17,n.assistant.owned$)))}}const j=[{path:"",component:(()=>{var e;class s{constructor(i,r,o,m,d,c,l){var E=this;this.cacheService=i,this.matDialog=r,this.dataService=o,this.accountService=m,this.walletService=d,this.route=c,this.web3Service=l,this.msgList=[{msg$:(0,v.of)("Hi~"),from:0}],this.msg="",this.assistantSubscription=this.route.paramMap.pipe((0,y.w)(_=>(this.collectionId=_.get("collectionID")||void 0,this.collectionId?this.cacheService.getAssistantById(this.collectionId):(0,v.of)(void 0)))).subscribe(function(){var _=(0,h.Z)(function*(C){E.assistant=C});return function(C){return _.apply(this,arguments)}}())}ngOnDestroy(){this.assistantSubscription.unsubscribe()}ngOnInit(){}typedMsg(i){return(0,T.a)([(0,O.H)(800,30),i]).pipe((0,k.U)(([r,o])=>o.substring(0,r)))}harvest(i,r){var o=this;this.assistant&&(i.stopPropagation(),(0,g.z)(this.accountService.account$).then(function(){var m=(0,h.Z)(function*(d){if(d){if(!o.accountService.getToken())try{if(0==(yield o.walletService.signMessage(d,"Hello FusionMate!")))return void setTimeout(()=>o.harvest(i,r),500)}catch{return}const c=yield(0,g.z)(o.assistant.ownedTokenId$).then(l=>{if(l.length>0)return(0,g.z)(o.dataService.harvest(r.collectionID,l[0]))});c&&(yield o.web3Service.invokeContract("Assistant","harvestForTBA",[c.data.signature,c.data.tokenID+"",c.data.tokenNum+"",c.data.collectionID+""],o.assistant.contractAddr))}else o.walletService.connect().then(()=>setTimeout(()=>o.mint(i,r),500))});return function(d){return m.apply(this,arguments)}}()))}mint(i,r){var o=this;i.stopPropagation(),(0,g.z)(this.accountService.account$).then(function(){var m=(0,h.Z)(function*(d){if(d){if(!o.accountService.getToken())try{if(0==(yield o.walletService.signMessage(d,"Hello FusionMate!")))return void setTimeout(()=>o.mint(i,r),500)}catch{return}o.matDialog.open(Z.s,{data:r})}else o.walletService.connect().then(()=>setTimeout(()=>o.mint(i,r),500))});return function(d){return m.apply(this,arguments)}}())}sendMsg(){this.msg&&this.assistant&&(0,g.z)(this.assistant.ownedTokenId$).then(i=>{if(i.length>0){this.userSpeak();const r=this.dataService.sendMsgV2(this.msg);this.botSpeak(r),this.msg=""}})}userSpeak(){this.msgList.push({msg$:(0,v.of)(this.msg),from:1}),this.scrollToBottom()}botSpeak(i){this.msgList.push({msg$:this.typedMsg(i),from:0}),this.scrollToBottom()}scrollToBottom(){setTimeout(()=>this.talkField.nativeElement.scrollTop=this.talkField.nativeElement.scrollHeight,200)}}return(e=s).\u0275fac=function(i){return new(i||e)(t.Y36(P.Q),t.Y36(w.uw),t.Y36(A.D),t.Y36(D.B),t.Y36(F.X),t.Y36(f.gz),t.Y36(I.U))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-detail"]],viewQuery:function(i,r){if(1&i&&t.Gf(S,5),2&i){let o;t.iGM(o=t.CRH())&&(r.talkField=o.first)}},decls:1,vars:1,consts:[["class","detail-wrapper",4,"ngIf"],[1,"detail-wrapper"],[1,"detail"],[1,"detail-img"],[2,"font-size","1.2rem","font-weight","bold","margin","1rem 0 0.5rem"],[1,"tag-list"],[1,"tag-item"],[2,"color","#FF521E"],["class","tag-item",4,"ngIf"],[1,"desc"],["mat-raised-button","",1,"mint-btn",3,"click"],[2,"margin-top","1rem","font-size","1.2rem","font-weight","bold"],[1,"text-feed"],["src","/assets/imgs/text_feed.png",2,"height","100%"],[1,"dot",2,"left","40%","top","30%","transform","scale(1.1)"],[1,"dot",2,"left","45%","top","5%","transform","scale(0.9)"],[1,"dot",2,"left","62%","top","10%","transform","scale(0.8)"],[1,"dot",2,"left","52%","top","22%","transform","scale(0.7)"],[1,"dialog"],[2,"margin","1rem 0 0 2rem"],[1,"talk-field"],["talkField",""],[4,"ngFor","ngForOf"],["class","bot-msg-wrapper",4,"ngIf"],["class","user-msg-wrapper",4,"ngIf"],[1,"bot-msg-wrapper"],[1,"bot-img"],[1,"bot-name"],[1,"bot-word-bubble"],[1,"user-msg-wrapper"],[1,"user-img"],[1,"user-name"],[1,"user-word-bubble"],["class","input-field",4,"ngIf"],[1,"input-field"],["type","text","placeholder","Please speak your mind...",3,"ngModel","ngModelChange","keyup.enter"],["mat-fab","","color","warn",1,"send-btn",3,"click"],[2,"font-size","1rem","margin","auto","font-weight","bold"],[3,"click"]],template:function(i,r){1&i&&t.YNc(0,L,35,21,"div",0),2&i&&t.Q6J("ngIf",r.assistant)},dependencies:[u.sg,u.O5,p.Fj,p.JJ,p.On,b.lW,b.cs,M.Hw,u.Ov],styles:['.detail-wrapper[_ngcontent-%COMP%]{padding:10vh 3rem 0;width:100vw;min-height:95vh;display:grid;grid-template-columns:1fr 3fr;column-gap:3rem}.detail[_ngcontent-%COMP%]{background:#161616;padding:1rem;border-radius:5px}.detail-img[_ngcontent-%COMP%]{width:10vw;height:10vw;background-size:100% 100%!important;background-position:center center!important;border-radius:8px;border:6px solid #3d3d3d;box-shadow:inset 0 0 3px 6px #31313199}.tag-list[_ngcontent-%COMP%]{display:flex;flex-direction:row}.tag-list[_ngcontent-%COMP%]   .tag-item[_ngcontent-%COMP%]{border-radius:2px;color:#fff;margin:.5rem 1rem .5rem 0;min-width:4rem;text-align:center;background:#252525;border:none}.desc[_ngcontent-%COMP%]{color:#737373;text-align:left;line-height:1.5;height:10vh;overflow:hidden;text-overflow:ellipsis}.mint-btn[_ngcontent-%COMP%]{border-radius:2px;padding:.5rem 1rem;background:#ff521e;font-size:1rem;font-weight:700;color:#252525;transition:all .2s}.mint-btn[_ngcontent-%COMP%]:hover{background:#ff521e;color:#fff}.text-feed[_ngcontent-%COMP%]{background:url(/assets/imgs/text_feed_bg.png);width:100%;padding:1rem;border-radius:5px;max-height:30vh;overflow-x:hidden;height:100%;display:flex;justify-content:center;align-items:center;position:relative}.text-feed[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{position:absolute;border-radius:50%;width:.5vw;height:.5vw;background:rgba(255,255,255,.85);box-shadow:0 0 1px .2vw #fff6;transition:all .2s;cursor:pointer}.text-feed[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]:hover{background:#ff521e;box-shadow:0 0 1px .2vw #ff531e4d}.text-feed-item[_ngcontent-%COMP%]{display:inline-block;border-radius:2px;color:#fff;margin:0 .5rem 1rem;padding:.1rem .5rem;min-width:4rem;text-align:center;background:#252525;border:none;word-wrap:normal}.dialog[_ngcontent-%COMP%]{background:#111111;border-radius:5px;display:grid;grid-template-rows:3rem 1fr 10vh;row-gap:1rem;width:100%}.talk-field[_ngcontent-%COMP%]{padding:1rem 2rem;overflow-y:scroll;overflow-x:hidden;width:100%;max-height:70vh}.input-field[_ngcontent-%COMP%]{background:#161616;padding:1rem;height:10vh;width:100%;display:flex}.input-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:5px;height:4vh;flex:1 1 auto;font-size:1rem;background:#161616;-webkit-appearance:none;appearance:none;outline:0;border:none;padding:0 1rem;color:#dedede}.input-field[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]{border-radius:4px}[_nghost-%COMP%]     .mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple, .mat-mdc-mini-fab[_ngcontent-%COMP%]:not(.mdc-fab--extended)   .mdc-fab__ripple[_ngcontent-%COMP%]{border-radius:4px!important}.bot-msg-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:5rem auto;grid-template-rows:1rem 1fr;column-gap:1rem;row-gap:1rem;margin-bottom:1rem}.bot-img[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:2;grid-row-start:1;grid-row-end:3;width:5rem;height:5rem;background-size:100% 100%!important;background-position:center center!important;border-radius:8px;border:3px solid #3d3d3d;box-shadow:inset 0 0 1px 3px #31313199}.bot-name[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;grid-row-start:1;grid-row-end:2}.bot-word-bubble[_ngcontent-%COMP%]{position:relative;grid-column-start:2;grid-column-end:3;grid-row-start:2;grid-row-end:3;max-width:40vw;margin-left:1rem;background:#202020;padding:1rem;border-radius:5px;word-wrap:break-word;width:-moz-fit-content;width:fit-content}.bot-word-bubble[_ngcontent-%COMP%]:before, .bot-word-bubble[_ngcontent-%COMP%]:after{position:absolute;top:0;left:-10px;display:block;font-size:0;line-height:0;border-color:#202020 transparent transparent;border-style:solid;border-width:10px;content:""}.user-msg-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 5rem;grid-template-rows:1rem 1fr;column-gap:1rem;row-gap:1rem;margin-bottom:1rem}.user-img[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;grid-row-start:1;grid-row-end:3;width:5rem;height:5rem;background:url(/assets/imgs/user_temp.png) no-repeat;background-size:100% 100%!important;background-position:center center!important;border-radius:8px;border:3px solid #3d3d3d;box-shadow:inset 0 0 1px 3px #31313199}.user-name[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:2;grid-row-start:1;grid-row-end:2;justify-self:end}.user-word-bubble[_ngcontent-%COMP%]{position:relative;grid-column-start:1;grid-column-end:2;grid-row-start:2;grid-row-end:3;max-width:40vw;margin-right:1rem;background:#515151;padding:1rem;border-radius:5px;justify-self:end;word-wrap:break-word;width:-moz-fit-content;width:fit-content}.user-word-bubble[_ngcontent-%COMP%]:before, .user-word-bubble[_ngcontent-%COMP%]:after{position:absolute;top:0;right:-10px;display:block;font-size:0;line-height:0;border-color:#515151 transparent transparent;border-style:solid;border-width:10px;content:""}']}),s})()}];let G=(()=>{var e;class s{}return(e=s).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(j),f.Bz]}),s})(),q=(()=>{var e;class s{}return(e=s).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,G,p.u5,b.ot,M.Ps,w.Is]}),s})()}}]);